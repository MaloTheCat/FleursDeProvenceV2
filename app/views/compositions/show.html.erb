<div class="compo-section-1">
  <div class="compo-s1-left">
    <% @composition.images.map do |image| %>
      <img src=<%= image %>></img>
    <% end %>

    <%#= humanized_money(@composition.price) %>
      <% Stripe::Price.list({product: @composition.id}).map do |pp| %>
        <% if pp[:nickname].match?(/\w[S]/) %>
          <h2 id="price"><%= pp[:unit_amount]/100 %></h2><h2>€</h2>
        <% end %>
      <% end %>

  </div>
  <div class="compo-s1-right">
    <h2><%= @composition.name %></h2>
    <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s.</p>
    <div class="compo-size">
      <div class="compo-size-text">
        <p>Taille du bouquet</p>
        <p>Guide des tailles</p>
      </div>
    </div>
    <%= form_with(url:orders_path) do |form| %>
      <%= hidden_field_tag 'composition_id', @composition.id %>
      <%= form.hidden_field 'prices_id', @compositionPrices %>

      <p>Sélectionnez votre point de retrait</p>
      <%= form.collection_select :relai_id, @relais, :id, :name %> </br>

      ID Composition : <%= @composition.id %></br><hr>
      <%# @compositionPrices.map do |price| %>
        <br>
        <%#= price.id %> -
        <!-- <span class=""><%#= price.nickname %></span> - -->
        <!-- <span class=""><%#= price.unit_amount/100 %></span> -->
        <br><br>
      <%# end %>

      <%= collection_radio_buttons :price, :price_id, @compositionPrices, :id, :nickname %>
      <!-- radio_button    ( object_name,     method,    tag_value,    options = {}) -->
      <%#= form.radio_button object_name, method, tag_value %>
        <%#= form.collection_radio_buttons @compositionPrices.id, @compositionPrices.nickname, @compositionPrices.unit_amount, :id, option={class:'radio'}  %>
      <%#= @composition.prices.each do |price| %>
        <%#= form.fields_for price, index: price.id do |price_form| %>
          <%#= price_form.text_field :unit_amount %>
        <%# end %>
      <%# end %>

      <%# @person.addresses.each do |address| %>
        <%#= person_form.fields_for address, index: address.id do |address_form| %>
          <%#= address_form.text_field :city %>

<!--  person = composition
      addresses = prices
      id[23,45] = id
      city = unit_amount
      -->

      <!-- <div id="radioBtns">
        <span class="">S</span>
        <input type="radio" class="size" name="radio" value="S" checked />
        <span class="">M</span>
        <input type="radio" class="size" name="radio" value="M" />
        <span class="">L</span>
        <input type="radio" class="size" name="radio" value="L" />
      </div> -->

                  <!-- doesn't work as a radio_button -->
                  <%# @compositionPrices.map do |price| %>
                    <!-- <span class=""><%#= price.nickname %></span> -->
                    <%#= form.radio_button price.nickname, price.unit_amount, options={} %>
                  <%# end %>
                  <!-- ------------------------------ -->


      <!-- radio_button( object_name,     method,    tag_value,    options = {}) -->
        <%#= radio_button :price_id, price.id, price.unit_amount %>
        <%#= radio_button(type) :price_id, price(.all), price.id(value) %>

      <!-- collection_radio_buttons( object ; method ; collection ; value_method ; text_method ; options = {} ; html_options = {},    options = {}) -->
        <%#= price.collection_radio_buttons :price, price, :id, price.unit_amount, price.nickname %>

      <!-- <span class=""><%#= price.id %></span>
        <input type="radio" class="size" name="radio" value="<%#= price.id %>" checked />
        <span class=""><%#= price.nickname %></span></br> -->

          <!-- <%# for price.nickname in price %>
            <%# if price.nickname.match?(/[S]/) %>
              <span class="">S</span>
              <input type="radio" class="size" name="radio" value="S" checked />
            <%# elsif price.nickname.match?(/[M]/) %>
              <span class="">M</span>
              <input type="radio" class="size" name="radio" value="M" checked />
            <%# else %>
              <span class="">L</span>
              <input type="radio" class="size" name="radio" value="L" checked />
            <%# end %>
          <%# end %> -->





        <%#= price.unit_amount/100 %>        <!-- => Price -->
        <%#= price.nickname %>               <!-- => Size -->

        <%#= price.select :size, [["S", "#{@price.nickname}"], ["M", "#{@price.nickname}"], ["L", "#{@composition.base_price+20}"]], {}, id:'size' %>
      <%# end %>
      <%#= radio_button @compositionPrice, :nickname, @price, option = {value["S", "M", "L"]} %>
<!--       <div id="radioBtns">
        <span class="">S</span>
        <input type="radio" class="size" name="radio" value="S" checked />
        <span class="">M</span>
        <input type="radio" class="size" name="radio" value="M" />
        <span class="">L</span>
        <input type="radio" class="size" name="radio" value="L" />
      </div> -->
      <%= form.submit 'Purchase', class: 'app-form-button' %>
    <% end %>
      <br>
      <br>
      <%#= fields_for :customer do |customer| %>
        <%#= customer.text_field :lastname, placeholder: 'Votre Nom' %>
        <%#= customer.text_field :firstname, placeholder: 'votre Prénom' %>
      <%# end %>
      <div id="map"
        style="width: 100%; height: 300px;"
        data-markers="<%#= @markers.to_json %>"
        data-mapbox-api-key="<%#= ENV['MAPBOX_API_KEY'] %>">
      </div>
  </div>
</div>

<%#= render partial: "pay/stripe/checkout_button", locals: {session: @checkout_session, title: "Acheter"} %>

<!-- A mettre sur view Home et view Compositions -->
<%# if @composition.disponibility == true %>
  <%#=  %>
<%# else %>
  <%#=  %>
<%# end %>

      <%#= f.fields_for :order do |ff| %>
        <%#= ff.collection_select :relai, @relais, :id, :name %>
        <%#= ff.association :relai, @relais, :relai_id, :name %>
        <%#= ff.label :relai %>
        <%#= ff.text_field :composition %>
      <%# end %>

      <%#= f.fields_for :composition do |f| %>
        <%#= f.label :composition %>
        <%#= f.association :composition, @compositions, [:id], :name %>
      <%# end %>
