<div class="compo-section-1">
  <div class="compo-s1-left">
    <%= cl_image_tag image_path(@composition.photo_title), alt: "#{@composition.photo_title}" %>
    <h2 id="price"><%= @composition.price %></h2><h2>€</h2>
  </div>
  <div class="compo-s1-right">
    <h2><%= @composition.name %></h2>
    <p>Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s.</p>
    <div class="compo-size">
      <div class="compo-size-text">
        <p>Taille du bouquet</p>
        <p>Guide des tailles</p>
      </div>
    </div>

    <%= form_with(model: @order, url: composition_orders_path(@composition), local: true) do |f| %>  <!-- url: composition_orders_path(@composition) or url: composition_orders_path(:composition_id) return a Routing Error: No route matches [PATCH] -->

      <%= f.hidden_field :id %>
      <%= f.select :size, [["S", "#{@composition.price}"], ["M", "#{@composition.price+10}"], ["L", "#{@composition.price+20}"]], {}, id:'size' %>
      <p>Sélectionnez votre point de retrait</p>
      <%= f.collection_select :relai, @relais, :id, :name %>

        <!-- @relai.id = <%#= @relai %> </br>
        @composition.id = <%#= @composition.id %> </br>
        @florist.id = <%#= @florist %> </br>
        @customer.id = <%#= @customer %> -->

      <%#= f.fields_for :order do |ff| %>
        <%#= ff.collection_select :relai, @relais, :id, :name %>
        <%#= ff.association :relai, @relais, :relai_id, :name %>
        <%#= ff.label :relai %>
        <%#= ff.text_field :composition %>
      <%# end %>

      <%#= f.fields_for :composition do |f| %>
        <%#= f.label :composition %>
        <%#= f.association :composition, @compositions, [:id], :name %>
      <%# end %>

      <div id="map"
        style="width: 100%; height: 300px;"
        data-markers="<%= @markers.to_json %>"
        data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>">
      </div>
      <%= f.submit "Acheter", class: "app-form-button no-display" %>
      <% case @composition.id %>
      <% when 1 %>
        <div id="price-id-s" class='app-form-button'><%= link_to 'Acheter', 'https://buy.stripe.com/test_fZe5nD4AHfuA4yA147' %></div>
        <div id="price-id-m" class='app-form-button'><%= link_to 'Acheter', 'https://buy.stripe.com/test_5kA7vL3wDbekc123ce' %></div>
        <div id="price-id-l" class='app-form-button'><%= link_to 'Acheter', 'https://buy.stripe.com/test_dR67vLffleqw5CEaEI' %></div>
      <% when 2 %>
        <div id="price-id-s" class='app-form-button'><%= link_to 'Acheter', 'https://buy.stripe.com/test_3cs6rHaZ5dmse9adQV' %></div>
        <div id="price-id-m" class='app-form-button'><%= link_to 'Acheter', 'https://buy.stripe.com/test_00g6rH2sz828aWYaEE' %></div>
        <div id="price-id-l" class='app-form-button'><%= link_to 'Acheter', 'https://buy.stripe.com/test_8wM3fv9V1gyE9SU6op' %></div>
      <% end  %>
    <% end %>

  </div>
</div>

<%#= render partial: "pay/stripe/checkout_button", locals: {session: @checkout_session, title: "Acheter"} %>

<!-- A mettre sur view Home et view Compositions -->
<%# if @composition.disponibility == true %>
  <%#=  %>
<%# else %>
  <%#=  %>
<%# end %>
